# Google Analytics for Jekyll

</h1>
</header><p>Google Analytics tracking is a free web analytics service offered by Google that tracks and reports website traffic. In this tutorial, I will show you how to add the new Global Site Tag script to your Jekyll website.</p><blockquote><p>The Global Site Tag provides streamlined tagging across Google’s site measurement, conversion tracking and remarketing products – giving you better control while making implementation easier. By using gtag.js, you will be able to benefit from the latest dynamic features and integrations as they become available.</p></blockquote><p>Login to <a href="https://analytics.google.com/" rel="nofollow">Google Analytics</a> and create a new property to receive a Tracking ID for your website.</p><h2 id="install-google-analytics-tracking" tabindex="-1">Install Google Analytics Tracking <a class="al" href="#install-google-analytics-tracking" aria-hidden="true">#</a></h2><p>First create a new file called <code>analytics.html</code> in your site's <code>_includes</code> directory.</p><p>Now paste the following Global Site Tag (gtag.js) in to your <code>analytics.html</code> file and save it.</p><pre><code class="language-js">&lt;script async src=&quot;https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{{ site.google_analytics }}');
&lt;/script&gt;
</code></pre><p>You will find the above Global Site Tag (gtag.js) under <strong>Admin &gt; Property &gt; Tracking Info &gt; Tracking Code</strong>. Your Tracking ID is displayed at the top of the page.</p><p>The <code>{{ site.google_analytics }}</code> liquid object I have included above will allow you to set your unique Tracking ID in Jekyll's <code>_config.yml</code> file.</p><h2 id="add-your-google-analytics-tracking-id-to-jekyll's-config-file" tabindex="-1">Add your Google Analytics Tracking ID to Jekyll’s Config File <a class="al" href="#add-your-google-analytics-tracking-id-to-jekyll's-config-file" aria-hidden="true">#</a></h2><p>Open your sites <code>_config.yml</code> file and add the following lines of code. It is important to reference your own Tracking ID, so replace <code>UA—XXXXXXXX-X</code> below with your websites unique Tracking ID.</p><pre><code class="language-yaml"># Google Analytics
google_analytics: UA—XXXXXXXX-X
</code></pre><p>Finally, Google recommends placing this script in the <code>&lt;head&gt;</code> section of your site, so that all visits to your website are tracked correctly.</p><p>This part may vary depending on what Jekyll theme you are using but you will need to paste the following code just before the end <code>&lt;/head&gt;</code> tag. For you this could be a <code>head.html</code> file located in your site's <code>_includes/</code> directory or your <code>default.html</code> file in <code>_layouts/</code> directory.</p><pre><code class="language-liquid">{% if site.google_analytics and jekyll.environment == 'production' %}
{% include analytics.html %}
{% endif %}
</code></pre><p>In future, when you run <code>bundle exec jekyll serve</code> your Analytics tracking will no longer render when browsing your website locally. This prevents visit from <code>localhost:4000</code> messing up your analytics because by default Jekyll's environment is set to development.</p><p>Great right?</p><p>&quot;But how do I setup Google Analytics to only track site visitors on a production environment?&quot; I hear you say.</p><h2 id="setting-jekyll's-environment-to-production" tabindex="-1">Setting Jekyll's Environment to Production <a class="al" href="#setting-jekyll's-environment-to-production" aria-hidden="true">#</a></h2><p>As I have mentioned, we only need to include Google's analytics script when Jekyll's environment is set to production. This prevents us from messing up our analytics with visits from our localhost development server.</p><p>If you are using Github Pages to build your site, GitHub Pages will automatically set <code>jekyll.environment == 'production'</code> for you.</p><p>If you are using another hosting provider, you will now need to prefix the build command with <code>JEKYLL_ENV=production</code> like so</p><pre><code class="language-shell">JEKYLL_ENV=production bundle exec jekyll build
</code></pre><p>If you have followed all the steps correctly, you should now have Google Analytics installed correctly on your Jekyll website.</p><p>Unsure?</p><p>Open your <code>_site</code> folder after you build your site. Check to see if Google Analytics tracking code was added to the <code>&lt;head&gt;</code> section of the generated files before you push updates to your live site.</p>
